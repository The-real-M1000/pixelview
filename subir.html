<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Subir Película</title>
    <link rel="stylesheet" href="subir.css">
    <script type="module" src="https://www.gstatic.com/firebasejs/10.13.1/firebase-app.js"></script>
    <script type="module" src="https://www.gstatic.com/firebasejs/10.13.1/firebase-firestore.js"></script>
</head>
<body>
    <header>
        <div class="logo">PixelView</div>
        <div class="buttons">
            <button onclick="window.location.href='index.html'">Inicio</button>
            <button onclick="window.open('https://www.paypal.me/jatmilop', '_blank')">Donar</button>
           
            <button onclick="window.open('https://forms.gle/NpyBVnuuHQ9iNPcT8', '_blank')">Reportar un Error</button>
            <button onclick="window.open('https://whatsapp.com/channel/0029Vaj0fgnCsU9K97c0H031', '_blank')">Canal de WhatsApp</button>
            <button onclick="window.open('mailto:streaming.pixelview@gmail.com', '_blank')">Contáctanos</button>
        </div>
    </header>

    <form id="videoForm">
        <label for="videoTitle">Título:</label>
        <input type="text" id="videoTitle" required>

        <label for="videoUrl">URL del video (Google Drive):</label>
        <input type="url" id="videoUrl" required>

        <label for="imageUrl">URL de la portada (Google Drive):</label>
        <input type="url" id="imageUrl" required>

        <label for="videoType">Tipo:</label>
        <select id="videoType" required>
            <option value="">Selecciona el tipo</option>
            <option value="pelicula">Película</option>
            <option value="serie">Serie</option>
        </select>

        <label for="videoGenere">Género:</label>
        <select id="videoGenere" required>
            <option value="">Selecciona un género</option>
            <option value="accion">Acción</option>
            <option value="aventura">Aventura</option>
            <option value="ciencia-ficcion">Ciencia Ficción</option>
            <option value="infantil">Infantil</option>
            <option value="comedia">Comedia</option>
            <option value="drama">Drama</option>
            <option value="terror">Terror</option>
        </select>

        <button type="submit">Subir video</button>
    </form>

    <script type="module">
        // Importar Firebase y Firestore desde el CDN
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.13.1/firebase-app.js";
        import { getFirestore, collection, addDoc } from "https://www.gstatic.com/firebasejs/10.13.1/firebase-firestore.js";

        // Configuración de Firebase
        const firebaseConfig = {
            apiKey: "AIzaSyAmHL0-1uJZgPAhxqDN4zA1uUXH-X6YtzY",
            authDomain: "pixelview-30.firebaseapp.com",
            projectId: "pixelview-30",
            storageBucket: "pixelview-30.appspot.com",
            messagingSenderId: "267067796738",
            appId: "1:267067796738:web:cadd6fd09b25f94fb5661b",
            measurementId: "G-4VPZX8PV0N"
        };

        // Inicializa Firebase
        const app = initializeApp(firebaseConfig);

        // Inicializa Firestore
        const db = getFirestore(app);

        // Referencias al formulario
        const videoForm = document.getElementById("videoForm");

        // Función para manejar el envío del formulario
        if (videoForm) {
            videoForm.addEventListener("submit", async (e) => {
                e.preventDefault();

                const videoTitle = document.getElementById("videoTitle").value;
                const videoUrl = document.getElementById("videoUrl").value;
                const imageUrl = document.getElementById("imageUrl").value;
                const videoType = document.getElementById("videoType").value;
                const videoGenere = document.getElementById("videoGenere").value;

                try {
                    // Añadir datos del video a Firestore
                    await addDoc(collection(db, "videos"), {
                        title: videoTitle,
                        videoUrl: videoUrl,
                        imageUrl: imageUrl,
                        type: videoType,
                        genere: videoGenere
                    });

                    alert("Video subido correctamente");
                    videoForm.reset(); // Limpiar el formulario
                } catch (error) {
                    console.error("Error al subir el video: ", error);
                }
            });
        }
    </script>
</body>
</html>
